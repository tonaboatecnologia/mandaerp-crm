<!DOCTYPE html>
<html lang="pt-AO">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Cartas - MANDA ERP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-size: 1.8rem;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #3498db;
            font-weight: bold;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 30px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .tab:hover {
            background: #f8f9fa;
        }
        
        .tab.active {
            background: #f8f9fa;
            border-bottom: 3px solid #3498db;
            color: #3498db;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 30px;
        }
        
        .card-header {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .card-body {
            padding: 25px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            text-align: center;
            transition: all 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #3498db;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .chart-container {
            height: 300px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        .btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .logo-upload {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .logo-preview {
            width: 100px;
            height: 100px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .logo-preview img {
            max-width: 100%;
            max-height: 100%;
        }
        
        .logo-preview i {
            font-size: 2rem;
            color: #bbb;
        }
        
        .letter-preview {
            background: white;
            padding: 30px;
            border: 1px solid #eee;
            border-radius: 8px;
            font-family: 'Times New Roman', serif;
            line-height: 1.6;
            color: #333;
            min-height: 600px;
            position: relative;
        }
        
        .letter-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }
        
        .letter-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .letter-subtitle {
            font-size: 1.1rem;
            margin-bottom: 15px;
        }
        
        .letter-contact {
            font-size: 0.9rem;
            color: #555;
        }
        
        .letter-logo {
            max-width: 150px;
            max-height: 80px;
            margin-bottom: 15px;
        }
        
        .letter-section {
            margin-bottom: 20px;
        }
        
        .letter-field {
            margin-bottom: 8px;
        }
        
        .letter-field-label {
            font-weight: bold;
            display: inline-block;
            width: 150px;
        }
        
        .letter-field-value {
            border-bottom: 1px dashed #ccc;
            padding-bottom: 2px;
            min-width: 200px;
            display: inline-block;
        }
        
        .letter-body {
            text-align: justify;
            margin-bottom: 30px;
        }
        
        .letter-signature {
            margin-top: 60px;
        }
        
        .letter-footer {
            margin-top: 40px;
            font-size: 0.9rem;
            color: #555;
        }
        
        .highlight {
            background-color: #fff9c4;
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #2ecc71;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
        }
        
        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .recent-letters {
            margin-top: 30px;
        }
        
        .letter-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .letter-item:last-child {
            border-bottom: none;
        }
        
        .letter-info {
            flex: 1;
        }
        
        .letter-company {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .letter-date {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .letter-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 0.85rem;
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .logo-upload {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div>
                <h1><i class="fas fa-file-alt"></i> Sistema de Geração de Cartas</h1>
                <p>MANDA ERP – Soluções Integradas de Gestão Empresarial</p>
            </div>
            <div class="user-info">
                <div>
                    <div>Administrador</div>
                    <div style="font-size: 0.8rem; opacity: 0.8;">admin@mandaerp.co.ao</div>
                </div>
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab active" onclick="openTab(event, 'dashboard')">
                <i class="fas fa-chart-bar"></i> Dashboard
            </div>
            <div class="tab" onclick="openTab(event, 'generator')">
                <i class="fas fa-edit"></i> Gerador de Cartas
            </div>
            <div class="tab" onclick="openTab(event, 'settings')">
                <i class="fas fa-cog"></i> Configurações
            </div>
            <div class="tab" onclick="openTab(event, 'history')">
                <i class="fas fa-history"></i> Histórico
            </div>
        </div>
        
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="stat-value">127</div>
                    <div class="stat-label">Cartas Geradas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-building"></i>
                    </div>
                    <div class="stat-value">89</div>
                    <div class="stat-label">Empresas Contatadas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-value">32%</div>
                    <div class="stat-label">Taxa de Resposta</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="stat-value">24</div>
                    <div class="stat-label">Reuniões Agendadas</div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-chart-line"></i> Estatísticas de Uso</h2>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="usageChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h2><i class="fas fa-industry"></i> Cartas por Setor</h2>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="sectorChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Generator Tab -->
        <div id="generator" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h1><i class="fas fa-edit"></i> Editor de Carta</h1>
                    <p class="subtitle">Preencha os campos para personalizar sua carta</p>
                </div>
                <div class="card-body">
                    <form id="letterForm">
                        <div class="form-group">
                            <label for="data">Data</label>
                            <input type="text" id="data" placeholder="DD de MMMM de AAAA" value="15 de Julho de 2023">
                        </div>
                        
                        <div class="form-group">
                            <label for="destinatarioCargo">Cargo/Função</label>
                            <select id="destinatarioCargo">
                                <option>Direção Geral</option>
                                <option>Direção Administrativa</option>
                                <option>Direção Comercial</option>
                                <option>Recursos Humanos</option>
                                <option>Departamento Financeiro</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="nomeEmpresa">Nome da Empresa/Instituição</label>
                            <input type="text" id="nomeEmpresa" placeholder="Nome da empresa">
                        </div>
                        
                        <div class="form-group">
                            <label for="endereco">Endereço</label>
                            <input type="text" id="endereco" placeholder="Endereço completo">
                        </div>
                        
                        <div class="form-group">
                            <label for="setorAtuacao">Setor de Atuação</label>
                            <select id="setorAtuacao">
                                <option>Educação</option>
                                <option>Comércio</option>
                                <option>Indústria</option>
                                <option>Serviços</option>
                                <option>Saúde</option>
                                <option>Outros</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="assuntoSetor">Setor Específico (Assunto)</label>
                            <input type="text" id="assuntoSetor" placeholder="Ex: Educação, Comércio, etc.">
                        </div>
                        
                        <div class="form-group">
                            <label for="tituloDestinatario">Título do Destinatário</label>
                            <input type="text" id="tituloDestinatario" placeholder="Ex: Sr., Sra., Dr.">
                        </div>
                        
                        <div class="form-group">
                            <label for="nomeDestinatario">Nome do Destinatário</label>
                            <input type="text" id="nomeDestinatario" placeholder="Nome completo">
                        </div>
                        
                        <div class="form-group">
                            <label for="setorEspecifico">Setor (Corpo da carta)</label>
                            <input type="text" id="setorEspecifico" placeholder="Ex: educação, comércio, etc.">
                        </div>
                        
                        <div class="form-group">
                            <label for="controleClientes">Controle de (clientes/estudantes)</label>
                            <input type="text" id="controleClientes" placeholder="Ex: clientes, estudantes, etc.">
                        </div>
                        
                        <div class="form-group">
                            <label for="controleServicos">e (serviços/matrículas)</label>
                            <input type="text" id="controleServicos" placeholder="Ex: serviços, matrículas, etc.">
                        </div>
                        
                        <div class="form-group">
                            <label for="caracteristicasSetor">Características do Setor</label>
                            <input type="text" id="caracteristicasSetor" placeholder="Ex: gestão acadêmica, etc.">
                        </div>
                        
                        <div class="form-group">
                            <label for="excelencia">Nível de Excelência</label>
                            <select id="excelencia">
                                <option>administrativa</option>
                                <option>pedagógica</option>
                                <option>comercial</option>
                                <option>operacional</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="tipoOrganizacao">Tipo de Organização</label>
                            <input type="text" id="tipoOrganizacao" placeholder="Ex: escolas, empresas, etc.">
                        </div>
                        
                        <div class="actions">
                            <button type="button" class="btn" id="generateBtn">
                                <i class="fas fa-sync-alt"></i> Atualizar Carta
                            </button>
                            <button type="button" class="btn btn-secondary" id="resetBtn">
                                <i class="fas fa-redo"></i> Limpar
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h1><i class="fas fa-file-alt"></i> Visualização da Carta</h1>
                    <p class="subtitle">Pré-visualização em tempo real</p>
                </div>
                <div class="card-body">
                    <div class="letter-preview" id="letterPreview">
                        <div class="letter-header">
                            <img id="letterLogo" class="letter-logo" src="" alt="Logo da Empresa" style="display: none;">
                            <div class="letter-title">CARTA DE SOLICITAÇÃO DE APRESENTAÇÃO DE SERVIÇOS</div>
                            <div class="letter-subtitle">MANDA ERP – Soluções Integradas de Gestão Empresarial</div>
                            <div class="letter-contact">
                                <p><strong>Remetente:</strong> MANDA ERP</p>
                                <p><strong>Sede:</strong> Icolo e Bengo – Calumbo (junto à Rádio Zango FM, defronte ao Hospital Amarelo)</p>
                                <p><strong>Tel.:</strong> +244 922 354 222 | +244 957 352 782 | +244 950 566 244</p>
                                <p><strong>E-mail:</strong> comercial@mandaerp.co.ao</p>
                                <p><strong>Website:</strong> www.mandaerp.co.ao</p>
                            </div>
                        </div>
                        
                        <div class="letter-section">
                            <div class="letter-field">
                                <span class="letter-field-label">Data:</span>
                                <span class="letter-field-value" id="previewData">15 de Julho de 2023</span>
                            </div>
                        </div>
                        
                        <div class="letter-section">
                            <p><strong>Destinatário:</strong></p>
                            <div class="letter-field">
                                <span class="letter-field-label">Cargo/Função:</span>
                                <span class="letter-field-value" id="previewCargo">Direção Geral</span>
                            </div>
                            <div class="letter-field">
                                <span class="letter-field-label">Empresa:</span>
                                <span class="letter-field-value" id="previewEmpresa">Nome da Empresa</span>
                            </div>
                            <div class="letter-field">
                                <span class="letter-field-label">Endereço:</span>
                                <span class="letter-field-value" id="previewEndereco">Endereço completo</span>
                            </div>
                            <div class="letter-field">
                                <span class="letter-field-label">Setor:</span>
                                <span class="letter-field-value" id="previewSetor">Educação</span>
                            </div>
                        </div>
                        
                        <div class="letter-section">
                            <p><strong>Assunto:</strong> Proposta de Colaboração – Apresentação de Soluções MANDA ERP para <span id="previewAssuntoSetor" class="highlight">Educação</span></p>
                        </div>
                        
                        <div class="letter-body">
                            <p>Prezado(a) <span id="previewTituloDestinatario" class="highlight">Sr.</span> <span id="previewNomeDestinatario" class="highlight">Nome do Destinatário</span>,</p>
                            
                            <p>O MANDA ERP tem como missão simplificar a gestão empresarial e impulsionar o crescimento das organizações através de tecnologia moderna, flexível e acessível, adaptada às necessidades específicas de cada segmento de mercado.</p>
                            
                            <p>Sabemos dos desafios que empresas do setor <span id="previewSetorEspecifico" class="highlight">educação</span> enfrentam na organização operacional, financeira e administrativa. Por isso, apresentamos uma solução integrada que oferece:</p>
                            
                            <ul>
                                <li>Automatização de processos administrativos e operacionais;</li>
                                <li>Gestão integrada de recursos humanos, financeiros e materiais;</li>
                                <li>Controle eficiente de <span id="previewControleClientes" class="highlight">estudantes</span> e <span id="previewControleServicos" class="highlight">matrículas</span>;</li>
                                <li>Relatórios gerenciais em tempo real para tomada de decisões estratégicas;</li>
                                <li>Portais digitais personalizados para diferentes perfis de usuários;</li>
                                <li>Transparência e eficiência em relatórios, documentos oficiais e gestão financeira;</li>
                                <li>Integração com sistemas de comunicação (WhatsApp/SMS) e armazenamento digital;</li>
                                <li>Soluções específicas para <span id="previewCaracteristicasSetor" class="highlight">gestão acadêmica</span>.</li>
                            </ul>
                            
                            <p>Oferecemos planos acessíveis e escaláveis, adaptados ao porte e às necessidades específicas de sua organização, desde soluções básicas até pacotes completos com funcionalidades avançadas de gestão e automação.</p>
                            
                            <p>Estamos convictos de que <span id="previewNomeEmpresa2" class="highlight">Nome da Empresa</span> poderá não apenas reduzir custos operacionais, mas também elevar o nível de excelência <span id="previewExcelencia" class="highlight">administrativa</span>, tornando-se referência na gestão moderna de <span id="previewTipoOrganizacao" class="highlight">escolas</span>.</p>
                            
                            <p>Dessa forma, solicitamos a oportunidade de uma apresentação formal (presencial ou online) com a vossa equipe diretiva, para demonstrarmos como o MANDA ERP pode agregar valor imediato à vossa organização.</p>
                            
                            <p>Aguardamos o vosso melhor agendamento e permanecemos à disposição para quaisquer esclarecimentos.</p>
                            
                            <p>Atenciosamente,</p>
                        </div>
                        
                        <div class="letter-signature">
                            <p>Ricardo Massungui</p>
                            <p>Gerente Comercial – MANDA ERP</p>
                        </div>
                        
                        <div class="letter-footer">
                            <p><strong>Contactos Diretos:</strong></p>
                            <p>📞 +244 922 354 222 | +244 957 352 782 | +244 950 566 244</p>
                            <p>✉️ comercial@mandaerp.co.ao | ricardojoaomassungui@gmail.com</p>
                            <p>🌐 www.mandaerp.co.ao</p>
                        </div>
                    </div>
                    
                    <div class="actions">
                        <button type="button" class="btn" id="printBtn">
                            <i class="fas fa-print"></i> Imprimir Carta
                        </button>
                        <button type="button" class="btn btn-success" id="pdfBtn">
                            <i class="fas fa-file-pdf"></i> Exportar PDF
                        </button>
                        <button type="button" class="btn btn-secondary" id="copyBtn">
                            <i class="fas fa-copy"></i> Copiar Texto
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h1><i class="fas fa-cog"></i> Configurações do Sistema</h1>
                </div>
                <div class="card-body">
                    <div class="form-group">
                        <label>Upload do Logotipo</label>
                        <div class="logo-upload">
                            <div class="logo-preview" id="logoPreview">
                                <i class="fas fa-image"></i>
                            </div>
                            <div>
                                <input type="file" id="logoUpload" accept="image/*" style="display: none;">
                                <button type="button" class="btn" onclick="document.getElementById('logoUpload').click()">
                                    <i class="fas fa-upload"></i> Selecionar Imagem
                                </button>
                                <p style="margin-top: 10px; font-size: 0.9rem; color: #7f8c8d;">
                                    Formatos suportados: JPG, PNG, GIF. Tamanho máximo: 2MB.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="companyName">Nome da Empresa</label>
                        <input type="text" id="companyName" value="MANDA ERP">
                    </div>
                    
                    <div class="form-group">
                        <label for="companyAddress">Endereço da Empresa</label>
                        <input type="text" id="companyAddress" value="Icolo e Bengo – Calumbo (junto à Rádio Zango FM, defronte ao Hospital Amarelo)">
                    </div>
                    
                    <div class="form-group">
                        <label for="companyPhone">Telefone</label>
                        <input type="text" id="companyPhone" value="+244 922 354 222 | +244 957 352 782 | +244 950 566 244">
                    </div>
                    
                    <div class="form-group">
                        <label for="companyEmail">E-mail</label>
                        <input type="text" id="companyEmail" value="comercial@mandaerp.co.ao">
                    </div>
                    
                    <div class="form-group">
                        <label for="companyWebsite">Website</label>
                        <input type="text" id="companyWebsite" value="www.mandaerp.co.ao">
                    </div>
                    
                    <div class="actions">
                        <button type="button" class="btn btn-success" id="saveSettingsBtn">
                            <i class="fas fa-save"></i> Salvar Configurações
                        </button>
                        <button type="button" class="btn btn-secondary" id="resetSettingsBtn">
                            <i class="fas fa-undo"></i> Restaurar Padrão
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- History Tab -->
        <div id="history" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h1><i class="fas fa-history"></i> Histórico de Cartas</h1>
                </div>
                <div class="card-body">
                    <div class="recent-letters">
                        <div class="letter-item">
                            <div class="letter-info">
                                <div class="letter-company">Escola Primária do Futuro</div>
                                <div class="letter-date">15 de Julho de 2023 - Setor: Educação</div>
                            </div>
                            <div class="letter-actions">
                                <button class="btn btn-small"><i class="fas fa-eye"></i> Visualizar</button>
                                <button class="btn btn-small btn-secondary"><i class="fas fa-download"></i> PDF</button>
                                <button class="btn btn-small btn-danger"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                        
                        <div class="letter-item">
                            <div class="letter-info">
                                <div class="letter-company">Comércio Central Ltda</div>
                                <div class="letter-date">10 de Julho de 2023 - Setor: Comércio</div>
                            </div>
                            <div class="letter-actions">
                                <button class="btn btn-small"><i class="fas fa-eye"></i> Visualizar</button>
                                <button class="btn btn-small btn-secondary"><i class="fas fa-download"></i> PDF</button>
                                <button class="btn btn-small btn-danger"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                        
                        <div class="letter-item">
                            <div class="letter-info">
                                <div class="letter-company">Indústria de Alimentos SA</div>
                                <div class="letter-date">05 de Julho de 2023 - Setor: Indústria</div>
                            </div>
                            <div class="letter-actions">
                                <button class="btn btn-small"><i class="fas fa-eye"></i> Visualizar</button>
                                <button class="btn btn-small btn-secondary"><i class="fas fa-download"></i> PDF</button>
                                <button class="btn btn-small btn-danger"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                        
                        <div class="letter-item">
                            <div class="letter-info">
                                <div class="letter-company">Clínica Médica Central</div>
                                <div class="letter-date">28 de Junho de 2023 - Setor: Saúde</div>
                            </div>
                            <div class="letter-actions">
                                <button class="btn btn-small"><i class="fas fa-eye"></i> Visualizar</button>
                                <button class="btn btn-small btn-secondary"><i class="fas fa-download"></i> PDF</button>
                                <button class="btn btn-small btn-danger"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="toast" id="toast">Operação realizada com sucesso!</div>
    
    <script>
        // Elementos do formulário
        const formElements = {
            data: document.getElementById('data'),
            destinatarioCargo: document.getElementById('destinatarioCargo'),
            nomeEmpresa: document.getElementById('nomeEmpresa'),
            endereco: document.getElementById('endereco'),
            setorAtuacao: document.getElementById('setorAtuacao'),
            assuntoSetor: document.getElementById('assuntoSetor'),
            tituloDestinatario: document.getElementById('tituloDestinatario'),
            nomeDestinatario: document.getElementById('nomeDestinatario'),
            setorEspecifico: document.getElementById('setorEspecifico'),
            controleClientes: document.getElementById('controleClientes'),
            controleServicos: document.getElementById('controleServicos'),
            caracteristicasSetor: document.getElementById('caracteristicasSetor'),
            excelencia: document.getElementById('excelencia'),
            tipoOrganizacao: document.getElementById('tipoOrganizacao')
        };
        
        // Elementos de visualização
        const previewElements = {
            data: document.getElementById('previewData'),
            cargo: document.getElementById('previewCargo'),
            empresa: document.getElementById('previewEmpresa'),
            endereco: document.getElementById('previewEndereco'),
            setor: document.getElementById('previewSetor'),
            assuntoSetor: document.getElementById('previewAssuntoSetor'),
            tituloDestinatario: document.getElementById('previewTituloDestinatario'),
            nomeDestinatario: document.getElementById('previewNomeDestinatario'),
            setorEspecifico: document.getElementById('previewSetorEspecifico'),
            controleClientes: document.getElementById('previewControleClientes'),
            controleServicos: document.getElementById('previewControleServicos'),
            caracteristicasSetor: document.getElementById('previewCaracteristicasSetor'),
            excelencia: document.getElementById('previewExcelencia'),
            tipoOrganizacao: document.getElementById('previewTipoOrganizacao'),
            nomeEmpresa2: document.getElementById('previewNomeEmpresa2')
        };
        
        // Função para atualizar a visualização
        function updatePreview() {
            previewElements.data.textContent = formElements.data.value || 'DD de MMMM de AAAA';
            previewElements.cargo.textContent = formElements.destinatarioCargo.value;
            previewElements.empresa.textContent = formElements.nomeEmpresa.value || 'Nome da Empresa';
            previewElements.endereco.textContent = formElements.endereco.value || 'Endereço completo';
            previewElements.setor.textContent = formElements.setorAtuacao.value;
            previewElements.assuntoSetor.textContent = formElements.assuntoSetor.value || formElements.setorAtuacao.value;
            previewElements.tituloDestinatario.textContent = formElements.tituloDestinatario.value || 'Sr.';
            previewElements.nomeDestinatario.textContent = formElements.nomeDestinatario.value || 'Nome do Destinatário';
            previewElements.setorEspecifico.textContent = formElements.setorEspecifico.value || formElements.setorAtuacao.value.toLowerCase();
            previewElements.controleClientes.textContent = formElements.controleClientes.value || 'clientes/estudantes';
            previewElements.controleServicos.textContent = formElements.controleServicos.value || 'serviços/matrículas';
            previewElements.caracteristicasSetor.textContent = formElements.caracteristicasSetor.value || 'características do setor';
            previewElements.excelencia.textContent = formElements.excelencia.value;
            previewElements.tipoOrganizacao.textContent = formElements.tipoOrganizacao.value || 'tipo de organização';
            previewElements.nomeEmpresa2.textContent = formElements.nomeEmpresa.value || 'Nome da Empresa';
            
            showToast('Carta atualizada com sucesso!');
        }
        
        // Função para mostrar notificação
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Função para alternar abas
        function openTab(evt, tabName) {
            const tabContents = document.getElementsByClassName('tab-content');
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            const tabs = document.getElementsByClassName('tab');
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            document.getElementById(tabName).classList.add('active');
            evt.currentTarget.classList.add('active');
        }
        
        // Event Listeners
        document.getElementById('generateBtn').addEventListener('click', updatePreview);
        
        document.getElementById('resetBtn').addEventListener('click', function() {
            document.getElementById('letterForm').reset();
            updatePreview();
            showToast('Formulário limpo!');
        });
        
        document.getElementById('printBtn').addEventListener('click', function() {
            window.print();
        });
        
        document.getElementById('copyBtn').addEventListener('click', function() {
            const letterContent = document.getElementById('letterPreview').innerText;
            navigator.clipboard.writeText(letterContent)
                .then(() => {
                    showToast('Texto copiado para a área de transferência!');
                })
                .catch(err => {
                    console.error('Erro ao copiar texto: ', err);
                    showToast('Erro ao copiar texto!');
                });
        });
        
        document.getElementById('pdfBtn').addEventListener('click', function() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Adicionar logo se existir
            const logoImg = document.getElementById('letterLogo');
            if (logoImg.src && logoImg.src !== window.location.href) {
                doc.addImage(logoImg, 'PNG', 15, 15, 50, 30);
            }
            
            // Adicionar conteúdo da carta
            const letterContent = document.getElementById('letterPreview');
            const content = letterContent.innerText;
            
            doc.setFontSize(12);
            const splitContent = doc.splitTextToSize(content, 170);
            doc.text(splitContent, 15, 60);
            
            // Salvar PDF
            const companyName = formElements.nomeEmpresa.value || 'Empresa';
            const date = new Date().toISOString().slice(0, 10);
            doc.save(`Carta_${companyName}_${date}.pdf`);
            
            showToast('PDF exportado com sucesso!');
        });
        
        // Upload de logo
        document.getElementById('logoUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    const logoPreview = document.getElementById('logoPreview');
                    const letterLogo = document.getElementById('letterLogo');
                    
                    logoPreview.innerHTML = `<img src="${event.target.result}" alt="Logo">`;
                    letterLogo.src = event.target.result;
                    letterLogo.style.display = 'block';
                    
                    // Salvar no localStorage
                    localStorage.setItem('companyLogo', event.target.result);
                    
                    showToast('Logo atualizado com sucesso!');
                };
                
                reader.readAsDataURL(file);
            }
        });
        
        // Salvar configurações
        document.getElementById('saveSettingsBtn').addEventListener('click', function() {
            const settings = {
                companyName: document.getElementById('companyName').value,
                companyAddress: document.getElementById('companyAddress').value,
                companyPhone: document.getElementById('companyPhone').value,
                companyEmail: document.getElementById('companyEmail').value,
                companyWebsite: document.getElementById('companyWebsite').value
            };
            
            localStorage.setItem('companySettings', JSON.stringify(settings));
            showToast('Configurações salvas com sucesso!');
        });
        
        // Restaurar configurações padrão
        document.getElementById('resetSettingsBtn').addEventListener('click', function() {
            document.getElementById('companyName').value = 'MANDA ERP';
            document.getElementById('companyAddress').value = 'Icolo e Bengo – Calumbo (junto à Rádio Zango FM, defronte ao Hospital Amarelo)';
            document.getElementById('companyPhone').value = '+244 922 354 222 | +244 957 352 782 | +244 950 566 244';
            document.getElementById('companyEmail').value = 'comercial@mandaerp.co.ao';
            document.getElementById('companyWebsite').value = 'www.mandaerp.co.ao';
            
            localStorage.removeItem('companySettings');
            showToast('Configurações restauradas com sucesso!');
        });
        
        // Carregar configurações salvas
        function loadSettings() {
            const savedSettings = localStorage.getItem('companySettings');
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                document.getElementById('companyName').value = settings.companyName || 'MANDA ERP';
                document.getElementById('companyAddress').value = settings.companyAddress || 'Icolo e Bengo – Calumbo (junto à Rádio Zango FM, defronte ao Hospital Amarelo)';
                document.getElementById('companyPhone').value = settings.companyPhone || '+244 922 354 222 | +244 957 352 782 | +244 950 566 244';
                document.getElementById('companyEmail').value = settings.companyEmail || 'comercial@mandaerp.co.ao';
                document.getElementById('companyWebsite').value = settings.companyWebsite || 'www.mandaerp.co.ao';
            }
            
            const savedLogo = localStorage.getItem('companyLogo');
            if (savedLogo) {
                const logoPreview = document.getElementById('logoPreview');
                const letterLogo = document.getElementById('letterLogo');
                
                logoPreview.innerHTML = `<img src="${savedLogo}" alt="Logo">`;
                letterLogo.src = savedLogo;
                letterLogo.style.display = 'block';
            }
        }
        
        // Atualização em tempo real (opcional)
        Object.values(formElements).forEach(element => {
            element.addEventListener('input', updatePreview);
        });
        
        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            updatePreview();
            loadSettings();
            
            // Gráficos do Dashboard
            const usageCtx = document.getElementById('usageChart').getContext('2d');
            new Chart(usageCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul'],
                    datasets: [{
                        label: 'Cartas Geradas',
                        data: [12, 19, 15, 25, 22, 30, 28],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            const sectorCtx = document.getElementById('sectorChart').getContext('2d');
            new Chart(sectorCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Educação', 'Comércio', 'Indústria', 'Serviços', 'Saúde', 'Outros'],
                    datasets: [{
                        data: [35, 25, 15, 10, 10, 5],
                        backgroundColor: [
                            '#3498db',
                            '#2ecc71',
                            '#e74c3c',
                            '#f39c12',
                            '#9b59b6',
                            '#95a5a6'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
        });
        
        // Service Worker para PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('Service Worker registrado com sucesso:', registration);
                    })
                    .catch(error => {
                        console.log('Falha ao registrar o Service Worker:', error);
                    });
            });
        }
    </script>
</body>
</html>
